# Project Orgel
### èµ›åšéŸ³ä¹ç›’è®¡åˆ’ç¬¬ä¸€éƒ¨åˆ†
### Cyber Musicbox Project Part I

- [ä¸­æ–‡](#ä¸­æ–‡)
- [English](#english)

# ä¸­æ–‡
>## ç›®å½•
- [é¡¹ç›®çŠ¶æ€](#é¡¹ç›®çŠ¶æ€)
- [é…ä»¶](#é…ä»¶)
- [æŸä¸ªç®€çŸ­çš„å®‰è£…æŒ‡å—](#æŸä¸ªç®€çŸ­çš„å®‰è£…æŒ‡å—)
    - [ä¼ åŠ¨æ”¹é€ ](#ä¼ åŠ¨æ”¹é€ )
    - [å…«éŸ³ç›’åŠç”µæœºçš„å›ºå®š](#å…«éŸ³ç›’åŠç”µæœºçš„å›ºå®š)
    - [ç”µè·¯æ­å»º](#ç”µè·¯æ­å»º)
    - [æŽ§åˆ¶ç¨‹åºçƒ§å½•](#æŽ§åˆ¶ç¨‹åºçƒ§å½•)
- [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—)

>## é¡¹ç›®çŠ¶æ€
* åŸºç¡€åŽŸç†éªŒè¯ âœ”
* åŸºç¡€ UI âœ”
* æ›´å¤šå¯åœ¨UIä¸­è°ƒèŠ‚çš„å€¼ âœ”
* ç”µæµè‡ªåŠ¨ä¼˜åŒ– âŒ
* UI å¤šè¯­è¨€æ”¯æŒ âŒ
* é¡¹ç›®è‡ªè¿° ðŸš§

>## é…ä»¶
* å…«éŸ³ç›’ (åºŸè¯) *1
* ESP32-D0DWQ6 å¼€å‘æ¿ 30é’ˆ *1
* TMC2209 æ­¥è¿›ç”µæœºé©±åŠ¨æ¨¡å— *1
>âš æ³¨æ„ï¼šæ¨¡å—éœ€è¦æ”¯æŒä»¥ä¸²å£æ–¹å¼ä¸ŽMCUè¿›è¡Œé€šä¿¡
* 42BYGH40/39 æ­¥è¿›ç”µæœº *1  
>â„¹æ³¨ï¼šå¯ä»¥æ˜¯ä»»æ„ä¸¤ç›¸å››çº¿æ­¥è¿›ç”µæœº, ä½†å…¶åº”èƒ½å¤Ÿæä¾›è¶³å¤ŸåŠ›çŸ©(>=300mN\*m)
* 0.4æ¨¡é½¿è½®(60é½¿ä»¥ä¸Š) *1
>â„¹æ³¨ï¼šé½¿è½®è¶Šå¤§è¶Šå¥½ï¼Œé™ä½Žç”µæœºè½¬é€Ÿæ˜¯å‡å°å™ªéŸ³çš„æœ‰æ•ˆæ–¹æ³•
>âš æ³¨æ„ï¼šé½¿è½®éœ€è¦èƒ½å¤Ÿä¸Žç”µæœºè¾“å‡ºè½´åŒ¹é…
* æ—‹è½¬ç¼–ç å™¨ *1
* SSD1306 0.96 å¯¸ OLED æ¨¡å— *1
* ç”µæº (Plan A): USB-C PD è¯±éª—å™¨ *1, æ”¯æŒPDå¿«å……åè®®çš„å……ç”µå™¨ *1, MP1584 DC-DC é™åŽ‹æ¨¡å— *1
* ç”µæº (Plan B): 3.3/5/12v å¤šè·¯è¾“å‡ºç”µæºæ¨¡å— *1, 12v/2A ç”µæºé€‚é…å™¨ *1
* ç”¨äºŽå›ºå®šçš„M3èžºä¸ã€M3èžºæ¯è‹¥å¹²

## æŸä¸ªç®€çŸ­çš„å®‰è£…æŒ‡å—
æŽ¥ä¸‹æ¥çš„æ­¥éª¤ç»„æˆäº†ä¸€ä¸ªç®€çŸ­çš„å®‰è£…æŒ‡å—ã€‚æ­¥éª¤ä¾›å‚è€ƒï¼Œå¯æ ¹æ®å®žé™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚
### ä¼ åŠ¨æ”¹é€ 
å¦‚å›¾æ‰€ç¤ºï¼Œæ”¹è£…ç”µåŠ¨åªéœ€ä½¿ç”¨å…«éŸ³ç›’ä¼ åŠ¨éƒ¨åˆ†ä¸­çš„éƒ¨åˆ†é½¿è½®ã€‚ç”±äºŽé¿å¼€äº†ä¼ åŠ¨éƒ¨åˆ†ä¸­çš„æ˜“æŸé½¿è½®ï¼Œå¯¹è¯¥é½¿è½®æŸåçš„å…«éŸ³ç›’è¿›è¡Œæ”¹è£…ä¸å¤±ä¸ºä¸€ä¸ªç»ä½³é€‰æ‹©ã€‚

å°†å…«éŸ³ç›’åŽŸæœ¬ç”¨äºŽè¿žæŽ¥æ‰‹æŸ„çš„ä¼ åŠ¨é½¿è½®æ‹†ä¸‹ï¼Œä»¥ç¦ç”¨æ‰‹æŸ„ã€‚

é¦–å…ˆå°†å…«éŸ³ç›’æ‰‹æŸ„æ”¯æž¶éƒ¨åˆ†æ•´ä½“æ‹†ä¸‹ã€‚

éšåŽä½¿ç”¨å°–å˜´é’³å°†é½¿è½®æ”¯æž¶ç¨ç¨æŽ°å¼¯ä»¥å–å‡ºé½¿è½®ã€‚

æ‰‹æŸ„ä¹Ÿå¯å–ä¸‹ã€‚

æœ€åŽå°†æ”¯æž¶è£…å›žå…«éŸ³ç›’ã€‚
### å…«éŸ³ç›’åŠç”µæœºçš„å›ºå®š
æ¯«æ— ç–‘é—®ï¼Œç”µæœºéœ€è¦ä¸Žå…«éŸ³ç›’å›ºå®šåœ¨ä¸€èµ·ä»¥è¿›è¡Œä¼ åŠ¨ã€‚è¯¥éƒ¨åˆ†æœ‰è¾ƒå¤šæ–¹æ¡ˆå¯ä¾›é€‰æ‹©ï¼Œæ•…æ­¤å¤„å°†ä¸åšè¾ƒå¤šé˜è¿°ï¼Œå®žé™…åº”ç”¨æ—¶å¯ä¸å¿…éµç…§ã€‚

>âš æ³¨æ„ï¼šä¸è®ºä»¥ä½•ç§æ–¹å¼å›ºå®šï¼Œ**ç”µæœºé½¿è½®å¿…é¡»å°½é‡ä¸Žå…«éŸ³ç›’é½¿è½®ç´§å¯†é…åˆ**ï¼Œå¦åˆ™å¯èƒ½ä¼šäº§ç”Ÿå™ªéŸ³å¹¶æŸåé½¿è½®ã€‚

è€ƒè™‘åˆ°å…«éŸ³ç›’å¯èƒ½éœ€è¦ä¸€ä¸ªå…±é¸£è…”ï¼ŒæŽ¨èå°†å…«éŸ³ç›’ä¸Žç”µæœºå›ºå®šåœ¨æœ¨ç›’ä¸­ã€‚å¦‚ä¸è€ƒè™‘å…±é¸£ï¼Œæˆ–ä¸æ–¹ä¾¿å¯¹æœ¨ç›’è¿›è¡Œé’»å­”/å¼€æ§½ï¼Œåˆ™ä¹Ÿå¯å›ºå®šåœ¨æœ¨å—æˆ–å…¶ä»–ææ–™ä¸Šã€‚æ­¤å¤„ä»¥å›ºå®šåœ¨æœ¨ç›’ä¸­ä¸ºä¾‹ã€‚

ç”±äºŽ42ç”µæœºçš„ä½“ç§¯è¾ƒå¤§ï¼Œå› æ­¤å…«éŸ³ç›’åŽŸé…æœ¨ç›’å¤§æ¦‚çŽ‡éœ€è¦è¿›è¡Œæ›´æ¢ã€‚ç›®å‰å¸‚é¢ä¸Šæœ‰å¤šç§å°ºå¯¸æœ¨ç›’å¯ä¾›é€‰æ‹©ã€‚æ­¤å¤„ç¤ºä¾‹ä¸­çš„æœ¨ç›’å°ºå¯¸ä¸º é•¿20cm\*å®½13.5cm*é«˜9cm

å°†å…«éŸ³ç›’ä¸Žç”µæœºæ”¾å…¥ç›’ä¸­ï¼Œå¯¹ç©ºé—´è¿›è¡Œè§„åˆ’ã€‚ç”¨é“…ç¬”ç”»å‡ºï¼ŒéšåŽé’»å­”/å¼€æ§½ï¼Œå°†å…«éŸ³ç›’ä¸Žç”µæœºå›ºå®šåœ¨æœ¨ç›’ä¸­ã€‚
### ç”µè·¯æ­å»º
æœ¬é¡¹ç›®ä¸­çš„ç”µè·¯ååˆ†ç®€å•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![curcit_schema][schema_url]

å¤„äºŽç©ºé—´åˆ©ç”¨æ–¹é¢çš„è€ƒé‡ï¼ŒæŽ¨èä½¿ç”¨PCBå®žçŽ°ä¸Šå›¾ä¸­ç”µè·¯ã€‚æ°´å¹³ç¨€çƒ‚ï¼Œåªèƒ½ç”»å‡ºä¸€æ‰‹çƒ‚æ¿å­ã€‚å¦‚éœ€è¦ï¼Œè¯·ç‚¹å‡»[è¿™é‡Œ][gerber_url]ã€‚
>â„¹æ³¨ï¼šä»…é€‚ç”¨äºŽå°ºå¯¸ä¸º22\*17çš„MP1584æ¨¡å—ä¸Žç„ŠæŽ¥äº†TX,RXé’ˆè„šçš„ä¹ç§¯TMC2209æ¨¡å—

å¦‚æžœæ— æ³•è¿›è¡Œç„ŠæŽ¥ï¼Œåˆ™å¯ä»¥è€ƒè™‘ä½¿ç”¨é¢åŒ…æ¿å®ŒæˆæŽ¥çº¿ã€‚
### æŽ§åˆ¶ç¨‹åºçƒ§å½•
æ”¹è£…çš„æœ€åŽä¸€æ­¥æ˜¯å°†ç”µæœºæŽ§åˆ¶ç¨‹åºçƒ§å½•è‡³ESP32ä¸­ã€‚

é¦–å…ˆéœ€è¦åœ¨ç”µè„‘ä¸Šæ­å»ºArduino-ESP32çŽ¯å¢ƒã€‚[çŸ¥ä¹Žç”¨æˆ·é“ç†Šçš„æ–‡ç« ][zhihu_esp32_environment_url]å¯ä¾›å‚è€ƒã€‚

åœ¨çŽ¯å¢ƒæ­å»ºå®ŒæˆåŽï¼Œè¿˜éœ€è¦åœ¨åº“ç®¡ç†å™¨ä¸­å®‰è£…ä»¥ä¸‹åº“ï¼š
```
tcMenu
TMCStepper
U8g2
```
å‡†å¤‡å®ŒæˆåŽï¼Œä½¿ç”¨Arduino IDEæ‰“å¼€`Project-Oegel`æ–‡ä»¶å¤¹ä¸­çš„`Project-Orgel.ino`è¿›è¡Œçƒ§å½•ã€‚

## ä½¿ç”¨æŒ‡å—
>âš æ³¨æ„ï¼šç”±äºŽç¡¬ä»¶ç»„åˆåŠæ”¹è£…æ“ä½œçš„å¤šæ ·æ€§ï¼Œåœ¨ä¸åŒæƒ…å½¢ä¸‹è¿è¡Œå¯èƒ½è§¦å‘æœªçŸ¥çš„bugï¼Œå¦‚éƒ¨åˆ†åŠŸèƒ½ä¸å¯ç”¨ç­‰ã€‚è¯¥æŒ‡å—ä»…ä»£è¡¨åœ¨æµ‹è¯•ç¡¬ä»¶ä¸Šçš„æ“ä½œåŠè¿è¡Œæ•ˆæžœã€‚

>ðŸ›‘è­¦å‘Šï¼šæ­¥è¿›ç”µæœºé©±åŠ¨å™¨è¿è¡Œä¼šäº§ç”Ÿé«˜æ¸©ã€‚è¯·å°å¿ƒçƒ«ä¼¤ã€‚

### åˆæ¬¡ä½¿ç”¨
å°†ç¨‹åºé¦–æ¬¡çƒ§å½•è‡³ESP32æ—¶ï¼Œæ‰€æœ‰è®¾ç½®ä¸ºé»˜è®¤åˆå§‹å€¼0ã€‚è¯·éµç…§ä¸‹è¿°æ–¹æ³•è®¾ç½®é½¿è½®é½¿æ•°ã€è¿è¡Œç”µæµå¹¶ä¿å­˜åŽå†ä½¿ç”¨ã€‚
### åŸºæœ¬æ“ä½œ
åœ¨ä¸»è§†å›¾ä¸­ï¼Œæ—‹è½¬æ—‹é’®æ›´æ”¹BPMã€‚å•å‡»æ—‹é’®åˆ‡æ¢æ’­æ”¾çŠ¶æ€ã€‚
![mainframe_zh][mainframe_zh_url]
### èœå•ä¸Žè®¾ç½®
åœ¨ä¸»è§†å›¾ä¸­é•¿æŒ‰å¯è¿›å…¥ä¸»èœå•ã€‚
![tomenu_zh][tomenu_zh_url]
åœ¨ä¸»èœå•ä¸­é€‰æ‹©`Back and Save`ä»¥ä¿å­˜è®¾ç½®å¹¶å›žåˆ°ä¸»èœå•ã€‚åœ¨ä¸»èœå•ä¸­æ— æ“ä½œ30ç§’ä¼šè‡ªåŠ¨è¿”å›žä¸»ç•Œé¢ã€‚

>âš æ³¨æ„ï¼šåœ¨æ›´æ”¹èœå•ä¸­é€‰é¡¹å€¼åŽå¿…é¡»é€šè¿‡`Back and Save`é€‰é¡¹é€€å‡ºèœå•ï¼Œå¦åˆ™åœ¨é‡å¯åŽé€‰é¡¹å€¼å°†æ¢å¤æ›´æ”¹å‰çŠ¶æ€ã€‚

åœ¨èœå•ä¸­æ—‹è½¬æ—‹é’®æŸ¥çœ‹é€‰é¡¹ï¼Œå•å‡»æ—‹é’®ä»¥ä¸Žé€‰é¡¹äº¤äº’ã€‚åœ¨äº¤äº’çŠ¶æ€ä¸‹æ—‹è½¬æ—‹é’®ä»¥æ›´æ”¹é€‰é¡¹å€¼ï¼Œå•å‡»æ—‹é’®é€€å‡ºã€‚
![menu_zh][menu_zh_url]
å„å¯è°ƒèŠ‚å€¼è¯´æ˜Žï¼š
 - Motorèœå•
     - Direction: æŽ§åˆ¶ç”µæœºæ­£åè½¬
     - Gear Teeth: ç”µæœºé½¿è½®é½¿æ•°è®¾ç½®
     - Current: ç”µæœºè¿è¡Œç”µæµè®¾ç½®ï¼Œå•ä½mA å‚è€ƒå€¼ï¼š1050mA 
    >âš æ³¨æ„ï¼šéšç€ç”µæµçš„å¢žå¤§ï¼Œé©±åŠ¨å™¨ä¼šäº§ç”Ÿæ›´å¤šçƒ­é‡å¹¶å¯èƒ½å¯¼è‡´è¿‡çƒ­ä¿æŠ¤ï¼Œç”µæœºå¯èƒ½ä¼šäº§ç”Ÿæ›´å¤§å™ªéŸ³ã€‚æ­£å¸¸ä½¿ç”¨è¯·ä¸è¦å°†è¯¥å€¼æå‡è‡³1700mAä»¥ä¸Šã€‚



# English
>## Table of Contents
- [Project Status](#project-ptatus)
- [Hardware Requirements](#hardware-requirements)
- [A Brief Installiation Guide](#a-brief-installiation-guide)
    - [Gear Modding](#gear-modding)
    - [Mounting](#mounting)
    - [Curcit](#circuit)
    - [Programming](#programming)
- [Usage](#usage)

>## Project Status 
* Make it work  âœ”
* A Basic UI    âœ”
* More Adjustable Values in UI âœ”
* Current Auto-Optimizing   âŒ
* UI MultiLanguage Support  âŒ
* Readme ðŸš§

>## Hardware Requirements
* Musicbox (of course) *1
* ESP32-D0DWQ6 Dev Moudle 30pin *1
* TMC2209 Stepper Driver Module *1
* 42BYGH40/39 Stepper *1  
 (Could be replaced with any 2-phase 4-wire step motor, however it should provide enough torque(>=300mN*m).)
* 0.4M gear(At least 60 teeth) *1   
* Rotatry Encoder *1
* SSD1306 0.96 inch OLED Screen *1
* Power Supply (Plan A): USB-C PD Trigger/Decoy *1, Phone charger with fast charging support *1, MP1584 DC-DC step-down moudle *1
* Power Supply (Plan B): 3.3/5/12v multi-output power moudle *1, 12v/2A AC/DC adapter *1
* M3 Screws & Nuts for Mounting

## A Brief Insalliation Guide
The following steps constitute a biref installiation guide, which you could refer to but donâ€™t have to follow
### Gear Modding
blablabla
### Mounting
blablabla
### Circuit
blablabla
### Programming
blablabla

## Usage


[mainframe_zh_url]:https://github.com/mr258876/Project-Orgel/raw/main/pics/MainFrame_zh.png
[tomenu_zh_url]:https://github.com/mr258876/Project-Orgel/raw/main/pics/ToMenu_zh.png
[menu_zh_url]:https://github.com/mr258876/Project-Orgel/raw/main/pics/Menu_zh.png
[schema_url]:https://github.com/mr258876/Project-Orgel/raw/main/PCB/Schematic_Project%20Orgel_2021-11-29.png
[gerber_url]:https://github.com/mr258876/Project-Orgel/raw/main/PCB/Gerber_PCB_Project%20Orgel.zip
[zhihu_esp32_environment_url]:https://zhuanlan.zhihu.com/p/107804270